{% extends "layout.html" %}
{% block content %}
<div class="container">
    <form action="" method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}

        <div class="alert alert-{{'success' if uploadSuccess else 'danger'}}" role="alert">
            {{ "Upload success" if uploadSuccess else "Have not uploaded yet"}}
        </div>

        <div class="form-group">
            {{ form.excel_file.label }}
            {{ form.excel_file(class="form-control-file") }}
            {% if form.excel_file.errors %}
            {% for error in form.excel_file.errors %}
            <span class="text-danger">{{ error }}</span></br>
            {% endfor %}
            {% endif %}
        </div>

        <div class="form-group d-flex align-items-baseline">
            {{ form.confirm.label }}
            {{ form.confirm(class="ml-3") }}
        </div>

        <div class="form-group">
            {{ form.submit(class="btn btn-outline-info") }}
        </div>

        <div class="form-group">
            {% if sheetValues %}
                <table class="table table-success table-striped">
                    {% for row in sheetValues %}
                    <tr>
                        <th class="px-3">{{convert_float_to_int(row[0])}}</th>
                        <th class="px-3">{{row[1]}}</th>
                        <th class="px-3">{{row[2]}}</th>
                        <th class="px-3">{{convert_float_to_int(row[3])}}</th>
                        <th class="px-3">{{row[4]}}</th>
                        <th class="px-3">{{row[5]}}</th>
                        <th class="px-3">{{row[6]}}</th>
                        <th class="px-3">{{row[7]}}</th>
                    </tr>
                    {% endfor %}
                </table>
            {% else %}
                <div>Nothing</div>
            {% endif %}
        </div>

    </form>
</div>
{% endblock content %}